services:
  ib-gateway:
    image: ghcr.io/gnzsnz/ib-gateway:stable
    container_name: ib_gateway
    restart: always
    # 读取同级目录下的 .env 文件
    environment:
      - TWS_USERID=${IB_USER}
      - TWS_PASSWORD=${IB_PASS}
      - TRADING_MODE=${IB_MODE:-paper}   # paper=模拟盘, live=实盘
      - VNC_PASSWORD=${VNC_PASS:-123456} # VNC 密码
      - TWOFA_TIMEOUT_ACTION=exit
    # 必须暴露端口，否则宿主机无法连接
    ports:
      - "4002:4002"  # 模拟盘 SSL 端口
      - "4001:4001"  # 实盘 SSL 端口
      - "5900:5900"  # VNC 远程桌面